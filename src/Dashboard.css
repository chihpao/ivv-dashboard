:root{
  --bg:#ffffff;
  --card:#ffffff;
  --muted:#64748b;
  --text:#0f172a;
  --line:#d0d5dd;
  --accent:#2f80ed;
  --radius:14px;
  --gap:14px;
  --chart-height:320px;
}

*{ box-sizing:border-box; }

.page{
  padding:16px;
  color:var(--text);
  min-height:100vh;
  width:100%;
  margin:0;
  display:flex;
  flex-direction:column;
  gap:var(--gap);
  box-sizing:border-box;
  max-width:100vw;
  overflow-x:hidden;
  background:#f5f7fb;
}


.loading{ padding:24px; }
.loading-screen{ min-height:100vh; display:flex; align-items:center; justify-content:center; padding:64px 20px; background:linear-gradient(145deg,#f8f2e9 0%, #fbf7ef 40%, #fffaf2 100%); }
.loading-shell{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:28px;
  padding:48px 56px;
  border-radius:28px;
  border:1px solid rgba(87,70,48,0.16);
  background:rgba(255,252,246,0.9);
  box-shadow:0 35px 80px -40px rgba(110,81,43,0.55);
  text-align:center;
  max-width:440px;
}
.loading-hero{
  position:relative;
  width:260px;
  height:220px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.loading-hero__orb{
  width:160px;
  height:160px;
  border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #ffe9c6 0%, #fddaa0 55%, #f9c26d 100%);
  box-shadow:0 20px 40px rgba(210,150,70,0.35);
  animation:hero-pulse 3.5s ease-in-out infinite;
}
.loading-hero__wave{
  position:absolute;
  border-radius:50%;
  border:2px solid rgba(197,134,61,0.38);
  width:200px;
  height:200px;
  animation:hero-wave 5.5s ease-in-out infinite;
}
.loading-hero__wave--one{ animation-delay:0.4s; }
.loading-hero__wave--two{ width:240px; height:240px; animation-delay:1.4s; }
.loading-hero__spark{
  position:absolute;
  width:10px;
  height:10px;
  border-radius:50%;
  background:#ffb561;
  box-shadow:0 0 18px rgba(255,181,97,0.9);
  animation:hero-spark 2.4s ease-in-out infinite;
}
.loading-hero__spark--one{ top:12%; left:22%; }
.loading-hero__spark--two{ bottom:20%; right:18%; animation-delay:0.4s; }
.loading-hero__spark--three{ top:28%; right:6%; animation-delay:0.8s; }
.loading-copy{ display:flex; flex-direction:column; gap:14px; color:#3c2f21; }
.loading-heading{ display:flex; flex-wrap:wrap; justify-content:center; gap:10px; font-size:32px; font-weight:700; letter-spacing:2px; }
.loading-heading__main{ text-transform:uppercase; }
.loading-heading__accent{ color:#c07b2c; }
.loading-ellipsis{ display:inline-flex; align-items:flex-end; gap:6px; }
.loading-ellipsis span{
  width:8px;
  height:8px;
  border-radius:50%;
  background:#c07b2c;
  animation:ellipsis-bounce 1.4s ease-in-out infinite;
}
.loading-ellipsis span:nth-child(2){ animation-delay:0.18s; }
.loading-ellipsis span:nth-child(3){ animation-delay:0.36s; }
.loading-message{ margin:0; font-size:16px; line-height:1.7; color:#665546; }
.loading-progress{ width:100%; height:6px; border-radius:999px; background:rgba(193,169,132,0.35); overflow:hidden; }
.loading-progress__bar{ display:block; width:40%; height:100%; background:linear-gradient(90deg,#c07b2c 0%, #ffa94d 100%); border-radius:inherit; animation:progress-sweep 1.6s ease-in-out infinite; }

@keyframes hero-pulse{
  0%,100%{ transform:scale(0.96); filter:brightness(1); }
  40%{ transform:scale(1.03); filter:brightness(1.05); }
  60%{ transform:scale(1); filter:brightness(1.1); }
}
@keyframes hero-wave{
  0%{ transform:scale(0.85); opacity:0.65; }
  50%{ transform:scale(1); opacity:0.15; }
  100%{ transform:scale(1.1); opacity:0; }
}
@keyframes hero-spark{
  0%,100%{ transform:translate3d(0,0,0) scale(0.9); opacity:0.6; }
  50%{ transform:translate3d(6px,-6px,0) scale(1.25); opacity:1; }
}
@keyframes ellipsis-bounce{
  0%,100%{ transform:translateY(0); opacity:0.4; }
  35%{ transform:translateY(-8px); opacity:1; }
  65%{ transform:translateY(-2px); opacity:0.7; }
}
@keyframes progress-sweep{
  0%{ transform:translateX(-60%); }
  50%{ transform:translateX(0); }
  100%{ transform:translateX(140%); }
}

.toolbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}
.title{ font-weight:700; font-size:20px; color:#1f2a37; }

.tool-actions{ display:flex; align-items:center; gap:8px; }
.tool-actions--disabled .label{ color:#9aa5b8; }
.filter-group{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; margin-left:auto; }
.select--placeholder{
  display:inline-flex;
  align-items:center;
  justify-content:flex-start;
  min-width:140px;
  height:32px;
  padding:6px 26px 6px 10px;
  border:1px dashed #95a1b7;
  border-radius:10px;
  background:#b8c0ce;
  box-shadow: inset 0 0 0 1px rgba(113,126,147,0.35);
  color:#6f7a8d;
  font-size:12px;
  letter-spacing:1px;
}
.select--placeholder span{ pointer-events:none; }
.label{ font-size:12px; color:var(--muted); }
.select{
  padding:6px 10px;
  border-radius:10px;
  border:1px solid #304255;
  background:#ffffff;
  color:var(--text);
  min-width:140px;
  width:140px;
}

.kpi-grid{
  display:grid;
  gap:var(--gap);
  grid-template-columns: repeat(1, minmax(0,1fr));
}
.kpi{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:14px;
}
.kpi-label{ font-size:12px; color:var(--muted); }
.kpi-value{ font-size:28px; font-weight:800; margin-top:6px; color:#0f172a; }
.kpi-detail{ margin-top:10px; }

.cards {
    display: grid;
    gap: var(--gap);
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    width: 100%;
    box-sizing: border-box;
  }
  

.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  min-height:360px;
}

.card--insights{ min-height:0; }

.card-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  flex-wrap:wrap;
}
.card-title{ font-size:14px; font-weight:700; }

.actions{ display:flex; gap:8px; }
.btn{
  padding:8px 12px;
  border-radius:10px;
  border:1px solid #37516d;
  background:#1b2735;
  color:#fff;
  font-size:12px;
  cursor:pointer;
}
.btn:disabled{ opacity:.6; cursor:not-allowed; }

.chart{ width:100%; height:var(--chart-height); }

.footer{ text-align:right; color:var(--muted); font-size:12px; }

.insights{ flex:1; }
.insights-list{
  margin:0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
  font-size:13px;
  color:#1f2a37;
}
.insights-list li{ line-height:1.5; }
.empty{ font-size:13px; color:var(--muted); }



/* 平板 */
@media (min-width:768px){
  .kpi-grid{ grid-template-columns: repeat(3, minmax(0,1fr)); }
  .cards{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* 桌面 */
@media (min-width: 1280px) {
  .kpi-grid { 
    grid-template-columns: repeat(5, minmax(0, 1fr));
    max-width: 100%;
  }
  .cards { 
    grid-template-columns: repeat(2, minmax(0, 1fr));
    max-width: 100%;
  }
  .page {
    padding: 16px 24px;
  }
}

.drawer-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.drawer-overlay.active {
  opacity: 1;
  visibility: visible;
}

.drawer {
  position: fixed;
  top: 0;
  right: -450px;
  width: 450px;
  height: 100vh;
  background: var(--card);
  border-left: 1px solid var(--line);
  box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
  z-index: 1001;
  transition: right 0.3s ease;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.drawer.open {
  right: 0;
}

.drawer-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--line);
  background: #f8f9fa;
}

.drawer-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 700;
  color: var(--text);
}

.drawer-header button {
  background: none;
  border: none;
  font-size: 20px;
  color: var(--muted);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  transition: background-color 0.2s ease, color 0.2s ease;
}

.drawer-header button:hover {
  background: #e9ecef;
  color: var(--text);
}

.drawer-body {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}

.drawer-body p {
  margin: 0 0 16px 0;
  font-size: 14px;
  color: var(--muted);
}

.drawer-body table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}

.drawer-body th,
.drawer-body td {
  padding: 10px 8px;
  text-align: left;
  border-bottom: 1px solid #e9ecef;
}

.drawer-body th {
  background: #f8f9fa;
  font-weight: 700;
  color: var(--text);
}

.drawer-body td {
  color: var(--text);
}

.drawer-body tr:hover {
  background: #f8f9fa;
}

/* 抽屜容器 */
.table-container {
  max-height: 400px;
  overflow-y: auto;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  margin-top: 10px;
}

.table-container::-webkit-scrollbar {
  width: 6px;
}

.table-container::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 3px;
}

.table-container::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 3px;
}

.table-container::-webkit-scrollbar-thumb:hover {
  background: #a8a8a8;
}

/* 關閉按鈕樣式 */
.close-button {
  background: none;
  border: none;
  font-size: 20px;
  color: var(--muted);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  transition: background-color 0.2s ease, color 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 32px;
  height: 32px;
}

.close-button:hover {
  background: #e9ecef;
  color: var(--text);
}

.close-button:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* 手機版 drawer 樣式 */
@media (max-width: 767px) {
  .drawer {
    width: 100vw;
    right: -100vw;
  }

  .drawer-header {
    padding: 14px 16px;
  }

  .drawer-header h3 {
    font-size: 14px;
  }

  .drawer-body {
    padding: 16px;
  }

  .drawer-body table {
    font-size: 12px;
  }

  .drawer-body th,
  .drawer-body td {
    padding: 8px 6px;
  }

  .table-container {
    max-height: 300px;
  }
}

/* 平板版 drawer 樣式 */
@media (min-width: 768px) and (max-width: 1023px) {
  .drawer {
    width: 380px;
    right: -380px;
  }
}

/* 手機版 drawer 樣式 */
@media (max-width: 767px) {
  .drawer {
    width: 100vw;
    right: -100vw;
  }

  .drawer-header {
    padding: 14px 16px;
  }

  .drawer-header h3 {
    font-size: 14px;
  }

  .drawer-body {
    padding: 16px;
  }

  .drawer-body table {
    font-size: 12px;
  }

  .drawer-body th,
  .drawer-body td {
    padding: 8px 6px;
  }
}
